---
layout: post
title: "Trufflehog Shallow Clone Insecurity - Part III"
date: 2024-12-22
tags: ["github"]
published: false
---

**Contents**
* TOC
{:toc}

# Problem Statement

Following a compromised Github Action via shell injection, what exploitation is possible and how does this impact Trufflehog projects?

# Introduction

The Trufflehog general usage documentation uses just `pull_request`[^1]. A quick search on Github confirms this is the case. 










![Image]({{ site.baseurl }}/assets/images/github-action.png)

# Considerations

required workflows
masks
github app

# Token Types

* Default
* PAT
* Github App

# Attack buckets

* env var credentials / masked creds
* github workflow cache blasting
* oidc federation?
* permissions



# References

[^1]: [https://github.com/trufflesecurity/trufflehog?tab=readme-ov-file#general-usage](https://github.com/trufflesecurity/trufflehog?tab=readme-ov-file#general-usage)